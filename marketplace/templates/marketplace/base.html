<!-- Marketplace Base Template (standalone) -->
<!DOCTYPE html>
<html lang="en" data-theme="petio">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Marketplace{% endblock %}</title>
  <!-- DaisyUI + Tailwind CSS -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    /* Minimal active state styling for marketplace sub-nav */
    .nav-link.active { color: #3b82f6; font-weight: 700; }
  </style>
</head>
<body class="min-h-screen bg-base-200">
  <div class="drawer">
    <input id="system-drawer-toggle" type="checkbox" class="drawer-toggle" />
    <div class="drawer-content flex flex-col">
      <!-- Top Navbar (Marketplace-specific, hamburger only) -->
      <nav class="navbar sticky top-0 z-40 bg-base-100 border-b border-base-300">
        <div class="navbar-start">
          <label for="system-drawer-toggle" class="btn btn-ghost mr-2" aria-label="Open system navigation">
            <i class="fas fa-bars text-lg"></i>
          </label>
        </div>
        <div class="navbar-center hidden"></div>
        <div class="navbar-end hidden"></div>
      </nav>

      <main class="container mx-auto px-4 py-6">
        <!-- Marketplace Sub-Navigation -->
        <nav class="bg-base-200/80 backdrop-blur border-b border-base-300 -mt-4 -mx-4 mb-4 px-4 py-2 rounded-t-md">
          <div class="container mx-auto px-0">
            <ul class="menu menu-horizontal px-1 text-sm gap-1 overflow-x-auto whitespace-nowrap">
              <li><a href="{% url 'marketplace:home' %}" class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}"><i class="fas fa-store"></i> Listings</a></li>
              {% if request.user.is_authenticated %}
              <li><a href="{% url 'marketplace:listing_create' %}" class="nav-link {% if request.resolver_match.url_name == 'listing_create' %}active{% endif %}"><i class="fas fa-plus-square"></i> Create</a></li>
              <li><a href="{% url 'marketplace:messages' %}" class="nav-link {% if request.resolver_match.url_name == 'messages' %}active{% endif %}"><i class="fas fa-comments"></i> Inbox</a></li>
              <li><a href="{% url 'marketplace:transactions' %}" class="nav-link {% if request.resolver_match.url_name == 'transactions' %}active{% endif %}"><i class="fas fa-handshake"></i> Transactions</a></li>
              {% else %}
              <li><a href="{% url 'login' %}?next={% url 'marketplace:listing_create' %}" class="nav-link"><i class="fas fa-plus-square"></i> Create</a></li>
              <li><a href="{% url 'login' %}?next={% url 'marketplace:messages' %}" class="nav-link"><i class="fas fa-comments"></i> Inbox</a></li>
              <li><a href="{% url 'login' %}?next={% url 'marketplace:transactions' %}" class="nav-link"><i class="fas fa-handshake"></i> Transactions</a></li>
              {% endif %}
              <li><a href="{% url 'marketplace:dashboard' %}" class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
              {% if request.user.is_staff %}
              
              {% endif %}
            </ul>
          </div>
        </nav>

        {% block marketplace_content %}{% endblock %}
      </main>
    </div>

    <!-- System Navigation Sidebar -->
    <div class="drawer-side">
      <label for="system-drawer-toggle" aria-label="Close system navigation" class="drawer-overlay"></label>
      <aside class="min-h-full w-80 bg-base-200 text-base-content flex flex-col">
        <!-- Sidebar Header -->
        <div class="p-4 border-b border-base-300">
          <div class="flex items-center gap-3">
            <div class="avatar placeholder">
              <div class="bg-primary text-primary-content rounded-full w-10">
                <span class="text-lg"><i class="fas fa-paw"></i></span>
              </div>
            </div>
            <div>
              <h2 class="font-bold text-lg">PETio System</h2>
              <p class="text-sm opacity-70">IoT Pet Feeder</p>
            </div>
          </div>
        </div>

        <!-- Navigation Menu -->
        <nav class="flex-1 p-4">
          <ul class="menu menu-lg w-full">
            <li class="menu-title"><span>Applications</span></li>
            <li>
              <a href="/" class="flex items-center gap-3 p-3 rounded-lg hover:bg-base-300 transition-colors">
                <i class="fas fa-gamepad text-primary text-xl"></i>
                <div>
                  <div class="font-semibold">Controller</div>
                  <div class="text-sm opacity-70">Feed & Schedule Management</div>
                </div>
              </a>
            </li>
            <li>
              <a href="/social/" class="flex items-center gap-3 p-3 rounded-lg hover:bg-base-300 transition-colors">
                <i class="fas fa-users text-secondary text-xl"></i>
                <div>
                  <div class="font-semibold">Social</div>
                  <div class="text-sm opacity-70">Community & Sharing</div>
                </div>
              </a>
            </li>
            <li>
              <a href="/marketplace/" class="flex items-center gap-3 p-3 rounded-lg hover:bg-base-300 transition-colors">
                <i class="fas fa-store text-accent text-xl"></i>
                <div>
                  <div class="font-semibold">Marketplace</div>
                  <div class="text-sm opacity-70">Products & Services</div>
                </div>
              </a>
            </li>
          </ul>
        </nav>

        <!-- Sidebar Footer -->
        <div class="p-4 border-t border-base-300">
          <form method="post" action="{% url 'logout' %}" class="btn btn-ghost btn-block justify-start gap-3">
            {% csrf_token %}
            <button type="submit" class="flex items-center gap-3 w-full justify-start text-left">
              <i class="fas fa-sign-out-alt text-error"></i>
              <span>Logout</span>
            </button>
          </form>
        </div>
      </aside>
    </div>
  </div>
</body>
</html>